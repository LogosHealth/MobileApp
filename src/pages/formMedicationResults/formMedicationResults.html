<ion-header>
  <ion-navbar>
    <ion-title>Dosage & Results</ion-title>
    <ion-buttons right>
      <button ion-button icon-only (click)="attachRecord()">
        <ion-icon name='attach'></ion-icon>
      </button>
    </ion-buttons>
  </ion-navbar>
</ion-header>

<ion-content class="forms-examples-content">
    <div class="forms-examples-segment">
      <form [formGroup]="card_form" (ngSubmit)="saveRecord()">
        <ion-card class="sample-form">
          <h2 class = "section-title-center">{{ medication.medicationname }}</h2>
          <ion-row>
            <ion-item>
              <ion-label floating>Formulation</ion-label>
              <ion-input type="text" formControlName="formulation"></ion-input>
            </ion-item>
          </ion-row>
          <ion-row>
            <ion-item>
              <ion-label floating>For</ion-label>
              <ion-input type="text" formControlName="verbatimindication"></ion-input>
            </ion-item>
          </ion-row>

          <ion-row>
            <ion-col no-padding width-30>
              <ion-item>
                <ion-label floating>Current</ion-label>
                <ion-input type="text" formControlName="inventory"></ion-input>
              </ion-item>
            </ion-col>
            <ion-col no-padding width-30>
              <ion-item>
                <ion-label floating>Starting</ion-label>
                <ion-input type="text" formControlName="startinginventory"></ion-input>
              </ion-item>
            </ion-col>
            <ion-col no-padding width-37>
              <ion-item>
                <ion-label floating>Units</ion-label>
                <ion-select formControlName="inventoryunit">
                  <ion-option class="section-title" value="pills">Pills</ion-option>
                  <ion-option class="section-title" value="mL">mL</ion-option>
                  <ion-option class="section-title" value="units">Units</ion-option>
                  <ion-option class="section-title" value="sprays">Sprays</ion-option>
                  <ion-option class="section-title" value="inhales">Inhales</ion-option>
                </ion-select>
              </ion-item>
            </ion-col>
          </ion-row>
        </ion-card>

        <ion-card class="sample-form">
          <ion-row>
            <ion-col>
              <h2 class = "section-title" >Dose Info</h2>
            </ion-col>
          </ion-row>

          <ion-row>
            <ion-col no-padding width-60>
              <ion-item>
                <ion-label floating>Start Date</ion-label>
                <ion-datetime displayFormat="MMM-DD-YY hh:mm A"  formControlName="startdate" minuteValues="0,15,30,45"></ion-datetime>
              </ion-item>
              </ion-col>
              <ion-col no-padding width-40>
                <ion-item>
                  <ion-label floating>End Date</ion-label>
                  <ion-datetime displayFormat="MMM-DD-YY" formControlName="enddate"></ion-datetime>
                </ion-item>
              </ion-col>
          </ion-row>

          <ion-row>
            <ion-col no-padding width-50>
              <ion-item>
                <ion-label floating>Dosage</ion-label>
                <ion-input type="number" formControlName="dosage"></ion-input>
              </ion-item>
            </ion-col>
            <ion-col no-padding width-50>
              <ion-item>
                <ion-label floating>Dose Units</ion-label>
                <ion-select formControlName="doseunits">
                  <ion-option class="section-title" value="pills">Pills</ion-option>
                  <ion-option class="section-title" value="mL">mL</ion-option>
                  <ion-option class="section-title" value="units">Units</ion-option>
                  <ion-option class="section-title" value="sprays">Sprays</ion-option>
                  <ion-option class="section-title" value="inhales">Inhales</ion-option>
                </ion-select>
              </ion-item>
            </ion-col>
          </ion-row>
          <ion-row>
            <ion-col>
              <ion-item>
                <ion-label floating>Dose Frequency</ion-label>
                <ion-select formControlName="dosefrequency">
                  <ion-option class="section-title" value="As Needed">As Needed</ion-option>
                  <ion-option class="section-title" value="Once Daily">Once Daily</ion-option>
                  <ion-option class="section-title" value="Twice Daily">Twice Daily</ion-option>
                  <ion-option class="section-title" value="Every 8 Hours">Every 8 Hours</ion-option>
                  <ion-option class="section-title" value="Every 6 Hours">Every 6 Hours</ion-option>
                  <ion-option class="section-title" value="Every 4 Hours">Every 4 Hours</ion-option>
                </ion-select>
              </ion-item>
            </ion-col>
          </ion-row>

          <ion-row>
            <ion-col no-padding width-87>
              <h2 class = "section-title" (click)="presentHelp(myEvent)">Dose Tracking Typeâ“˜</h2>
            </ion-col>
            <ion-col class="columnAlign" no-padding width-10>
              <button ion-button block class="form-action-button-top"  type="button" (click)="openSchedule()">
                <ion-icon name="clock"></ion-icon>
              </button>
            </ion-col>
          </ion-row>

          <ion-row>
            <ion-item>
              <ion-label floating>Tracking type</ion-label>
              <ion-select formControlName="dosetrackingtype">
                <ion-option class="section-title" value="Implicit">Implicit</ion-option>
                <ion-option class="section-title" value="Explicit">Explicit</ion-option>
              </ion-select>
            </ion-item>
          </ion-row>

        </ion-card>

        <ion-card class="sample-form">
          <ion-row>
            <h2 class = "section-title" >Results</h2>
          </ion-row>

          <ion-row>
            <ion-col width-50>
              <ion-label class="section-checkbox-label">Ineffective
                <ion-checkbox formControlName="ineffectiveflag"></ion-checkbox>
              </ion-label>
            </ion-col>
            <ion-col width-50>
                <ion-label class="section-checkbox-label">Allergic
                  <ion-checkbox formControlName="allergyflag" ></ion-checkbox>
                </ion-label>
            </ion-col>
          </ion-row>

          <div formArrayName="sideeffects" *ngFor="let info of card_form.get('sideeffects').controls; let i = index;">
            <div [formGroupName]="i">
              <ion-row>
                <ion-col no-padding width-50>
                  <ion-item>
                    <ion-label floating>For</ion-label>
                    <ion-input type="text" formControlName="verbatimindication"></ion-input>
                  </ion-item>
                </ion-col>
                <ion-col no-padding width-37>
                  <ion-item>
                    <ion-label floating>Start</ion-label>
                    <ion-datetime displayFormat="MMM-DD-YY" formControlName="startdate"></ion-datetime>
                  </ion-item>
                </ion-col>
                <ion-col class="columnAlign" no-padding width-10>
                  <button ion-button block class="form-action-button"  type="button" (click)="updateTreatmentResults(i)">
                    <ion-icon name="share-alt"></ion-icon>
                  </button>
                </ion-col>
              </ion-row>
            </div>
          </div>

          <ion-row>
            <ion-col>
              <ion-item>
                <ion-label floating>Comments</ion-label>
                <ion-textarea type="text" formControlName="comments" autosize></ion-textarea>
              </ion-item>
            </ion-col>
          </ion-row>

        </ion-card>

        <section class="form-section">
         <ion-row no-padding class="multi-input-row">
            <ion-col no-padding width-50>
                <button ion-button block class="form-action-button" type="submit" [disabled]="!(card_form.dirty || card_form.valid)">Save</button>
            </ion-col>
            <ion-col no-padding width-50>
              <button ion-button block class="form-action-button" type="button" (click)="deleteRecord()" [disabled]="newRec">Delete</button>
            </ion-col>
         </ion-row>
        </section>
      </form>
    </div>
</ion-content>
